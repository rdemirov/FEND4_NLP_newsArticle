import { checkUrl } from "./helpers";

const mockResp = {
  polarity: "positive",
  subjectivity: "subjective",
  text:
    "Cinnamon is a spice made from the inner bark of the Cinnamomum tree.\n\nIt’s widely popular and has been linked to some impressive health benefits, including a lower risk of diabetes, cancer, and heart disease (1, ).\n\nThe two main types of cinnamon are:\n\nCassia cinnamon is more commonly found in supermarkets, given that it’s much cheaper than Ceylon cinnamon.\n\nWhile Cassia cinnamon is safe to eat in small to moderate amounts, eating too much may cause health problems because it contains high amounts of a compound called coumarin.\n\nResearch has found that eating too much coumarin may harm your liver and increase the risk of cancer ( , 4, ).\n\nFurthermore, eating too much Cassia cinnamon has been linked to many other side effects.\n\nHere are 6 possible side effects of eating too much Cassia cinnamon.\n\nCassia (or regular) cinnamon is a rich source of coumarin.\n\nThe coumarin content of ground Cassia cinnamon may range from 7 to 18 milligrams per teaspoon (2.6 grams), while Ceylon cinnamon only contains trace amounts of coumarin (6).\n\nThe tolerable daily intake of coumarin is approximately 0.05 mg/pound (0.1 mg/kg) of body weight, or 5 mg per day for a 130-pound (59-kg) person. This means that just 1 teaspoon of Cassia cinnamon could put you over the daily limit ( ).\n\nUnfortunately, several studies have found that eating too much coumarin may cause liver toxicity and damage (4, ).\n\nFor example, a 73-year-old woman developed a sudden liver infection causing liver damage after taking cinnamon supplements for only 1 week ( ). However, this case involved supplements that provided a higher dose than you would get from diet alone.\n\nAnimal studies have shown that eating too much coumarin, which is abundant in Cassia cinnamon, may increase the risk of certain cancers ( ).\n\nFor example, studies in rodents have found that eating too much coumarin can cause cancerous tumors to develop in the lungs, liver, and kidneys (8, 9, ).\n\nThe way in which coumarin may cause tumors is unclear.\n\nHowever, some scientists believe that coumarin causes DNA damage over time, increasing the risk of cancer (11).\n\nMost research on the cancerous effects of coumarin has been performed on animals. More human-based research is needed to see if the same link between cancer and coumarin applies to humans.\n\nSome people have experienced mouth sores from eating products that contain cinnamon flavoring agents (12, , ).\n\nCinnamon contains cinnamaldehyde, a compound that may trigger an allergic reaction when consumed in large amounts. Small amounts of the spice don’t seem to cause this reaction, as saliva prevents chemicals from staying in contact with the mouth for too long.\n\nIn addition to mouth sores, other symptoms of a cinnamaldehyde allergy include:\n\nWhile these symptoms aren’t necessarily serious, they can cause discomfort ( ).\n\nHowever, it’s important to note that cinnamaldehyde will only cause mouth sores if you’re allergic to it. You can get tested for this type of allergy with a skin patch test ( ).\n\nAlso, mouth sores seem to mostly affect those who use too much cinnamon oil and cinnamon-flavored chewing gums, as these products can contain more cinnamaldehyde.\n\nHaving chronic high blood sugar is a health problem. If left untreated, it may lead to diabetes, heart disease, and many other health problems (16).\n\nCinnamon is well-known for its ability to lower blood sugar. Studies have found that the spice can mimic the effects of insulin, a hormone that helps remove sugar from the blood ( , , ).\n\nWhile eating a bit of cinnamon may help lower your blood sugar, eating too much may cause it to fall too low. This is called hypoglycemia. It can lead to tiredness, dizziness, and possibly fainting ( ).\n\nPeople who are most at risk of experiencing low blood sugar are those taking medications for diabetes. This is because cinnamon may enhance the effects of these medications and cause your blood sugar to fall too low.\n\nEating too much ground cinnamon in a single sitting may cause breathing problems.\n\nThis is because the spice has a fine texture that can make it easy to inhale. Accidentally inhaling it can cause:\n\nAlso, the cinnamaldehyde in cinnamon is a throat irritant. It may cause further breathing problems (21).\n\nPeople with asthma or other medical conditions that affect breathing need to be especially careful of accidentally inhaling cinnamon, as they are more likely to experience trouble breathing.\n\nCinnamon is safe to eat in small to moderate amounts with most medications.\n\nHowever, taking too much may be an issue if you’re taking medication for diabetes, heart disease, or liver disease. This is because cinnamon may interact with those medications, either enhancing their effects or intensifying their side effects.\n\nFor example, Cassia cinnamon contains high amounts of coumarin, which can cause liver toxicity and damage if consumed in high amounts ( , 4, ).\n\nIf you’re taking medications that may affect your liver, such as paracetamol, acetaminophen, and statins, excessive intake of cinnamon may increase the chance of liver damage ( ).\n\nAlso, cinnamon may help lower your blood sugar, so if you’re taking medications for diabetes, the spice may enhance their effects and cause your blood sugar to fall too low.\n\nSince the “cinnamon challenge” has become wildly popular, many have attempted to eat large amounts of dry cinnamon.\n\nThis challenge involves eating a tablespoon of dry, ground cinnamon in under a minute without drinking water (22).\n\nWhile it may sound harmless, the challenge can be very dangerous.\n\nEating dry cinnamon can irritate your throat and lungs, as well as make you gag or choke. It can also permanently damage your lungs.\n\nThis is because the lungs cannot break down the fibers in the spice. It may accumulate in the lungs and cause lung inflammation known as aspiration pneumonia (23, ).\n\nIf aspiration pneumonia is left untreated, the lungs may become permanently scarred and possibly collapse ( ).\n\nCinnamon is generally safe to use in small amounts as a spice. It’s linked to many impressive health benefits.\n\nHowever, eating too much may cause potentially dangerous side effects.\n\nThis mostly applies to Cassia cinnamon because it’s a rich source of coumarin. Conversely, Ceylon cinnamon contains only trace amounts of coumarin.\n\nThe tolerable daily intake for coumarin is 0.05 mg per pound (0.1 mg per kg) of body weight. This is how much coumarin you can eat in a day without the risk of side effects ( ).\n\nThis equates up to 8 mg of coumarin per day for an adult weighing 178 pounds (81 kilograms). For reference, the amount of coumarin in 1 teaspoon (2.5 grams) of ground Cassia cinnamon ranges from 7 to 18 mg (6). Keep in mind that children may tolerate even less.\n\nAlthough Ceylon cinnamon contains only trace amounts of coumarin, excessive intake should be avoided. Cinnamon contains numerous other plant compounds that may have adverse effects when consumed in high amounts. Use all cinnamon sparingly as a spice.\n\nCinnamon is a delicious spice, linked to many health benefits.\n\nWhile eating small to moderate amounts is safe, eating too much may cause side effects. This mostly applies to Cassia or “regular” cinnamon because it contains high amounts of coumarin, which has been linked to conditions like liver damage and cancer.\n\nOn the other hand, Ceylon or “true” cinnamon only contains trace amounts of coumarin.\n\nWhile eating too much cinnamon may have some drawbacks, it’s a healthy spice that’s safe to eat in small to moderate amounts. Eating less than the tolerable daily intake is more than enough to provide you with its health benefits.",
  polarity_confidence: 0.44481879472732544,
  subjectivity_confidence: 1
};

function handleSubmit(event) {
  event.preventDefault();
  // check what text was put into the form field
  let formUrl = document.getElementById("url").value;
  const urlValid = checkUrl(formUrl);
  //   fetch(`http://localhost:${app_port}/analyzeSentiment`, {
  //     method: "POST",
  //     headers: {
  //       "Content-Type": "application/json"
  //     },
  //     body: JSON.stringify({ url: formUrl })
  //   })
  //     .then(res => res.json())
  //     .then(function(res) {
  //       if (res.error) alert(res.error);
  //       else {
  //         console.log(JSON.stringify(res));
  //         document.getElementById("results").innerHTML = res;
  //       }
  //     });
  const resultsDiv = document.getElementById("sentimentResults");
  while (resultsDiv.firstChild) {
    resultsDiv.removeChild(resultsDiv.firstChild);
  }
  console.log(urlValid);
  if (urlValid) {
    const responseProps = Object.keys(mockResp);
    for (let index = 0; index < responseProps.length; index++) {
      if (responseProps[index] !== "text") {
        const elementLabel = document.createElement("div");
        const elementValue = document.createElement("div");
        elementLabel.className = "dataLabel";
        let splitString = responseProps[index]
          .split("_")
          .map(item => item.charAt(0).toUpperCase() + item.slice(1));
        const fieldLabel = splitString.join(" ");
        elementLabel.textContent = fieldLabel;
        elementValue.classList.add("dataCell");
        elementValue.setAttribute("id", responseProps[index]);
        if (responseProps[index] === "polarity") {
          if (mockResp["polarity"] === "positive")
            elementValue.classList.add("colorGreen");
          else elementValue.classList.add("colorRed");
        }
        elementValue.textContent = mockResp[responseProps[index]];
        resultsDiv.appendChild(elementLabel);
        resultsDiv.appendChild(elementValue);
      }
    }
    const resultsParagraph = document.createElement("p");
    resultsParagraph.setAttribute("id", "resultsText");
    resultsParagraph.className = "dataCell_text";
    resultsParagraph.textContent = mockResp["text"];
    resultsDiv.appendChild(resultsParagraph);
  } else {
    const errorDiv = document.createElement("div");
    errorDiv.className = "error";
    errorDiv.textContent = "Please enter a valid URL";
    resultsDiv.appendChild(errorDiv);
  }
}

export { handleSubmit };
